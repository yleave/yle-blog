(self.webpackChunkyle_blog=self.webpackChunkyle_blog||[]).push([[1073],{20895:function(e,t,n){"use strict";n.d(t,{dK:function(){return i},_k:function(){return l},vc:function(){return s},rx:function(){return c},qo:function(){return r},Hk:function(){return d},Iz:function(){return m}});var o=n(31336),a=n.n(o);n(30892)(a()),n(54212).w(a()),n(74182)(a());var i=["en","zh"],l=!1,s=null,c="5228ca85",r=8,d=50,m={search_placeholder:"Search",see_all_results:"\u67e5\u770b\u6240\u6709\u76f8\u5173\u7ed3\u679c\ud83d\udc40",no_results:"\u62b1\u6b49\uff0c\u6682\u65f6\u6ca1\u6709\u8fd9\u65b9\u9762\u7684\u6587\u7ae0\ud83d\ude23.",search_results_for:'\u5173\u4e8e "{{ keyword }}" \u7684\u6240\u6709\u6587\u7ae0',search_the_documentation:"\u4ece\u5f53\u524d\u7ad9\u70b9\u4e2d\u67e5\u627e\u5173\u952e\u5b57",count_documents_found:"\u4e00\u5171\u627e\u5230\u4e86 {{ count }} \u7bc7\u76f8\u5173\u6587\u7ae0\ud83d\udc40",count_documents_found_plural:"\u4e00\u5171\u627e\u5230\u4e86 {{ count }} \u7bc7\u76f8\u5173\u6587\u7ae0\ud83d\udc40",no_documents_were_found:"\u5565\u4e5f\u6ca1\u627e\u5230\uff0c\u6362\u4e00\u4e2a\u5173\u952e\u8bcd\u5427\ud83d\ude35"}},25205:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var o,a,i,l,s,c,r,d,m,u,A=n(63349),v=n(41788),h=n(96156),f=n(67294),p=n(86591),g=n(99105),w=n(2212),M=n(52886),E=n(17047),x=n(29276),S=n(36194),b=n(54734),Z=n.p+"assets/images/grasslight-big-43728102ca7c7ab4a5e3eedb0572f7b9.jpg",k=function(e){function t(){var t;return t=e.call(this)||this,(0,h.Z)((0,A.Z)(t),"initDialog",(function(){(r=document.createElement("div")).className="model-dialog";var e=document.createElement("div");(m=document.createElement("a")).target="_blank",e.appendChild(m),u=document.createElement("div"),r.append(e,u),(d=new x.j(r)).name="dialog"})),(0,h.Z)((0,A.Z)(t),"clickLabel",(function(e){var n=e.target.name,o=n&&t.modelsMap[n];if(o){var l=o.model;if(l.activeEmote("Wave"),i.getObjectByName("dialog"))i.remove(d);else{var s=l.model.position;d.position.set(s.x,s.y+450,s.z),setTimeout((function(){return l.pause=!0}),2e3),m.innerText=o.blogTitle,m.href=o.friendAddr,u.innerText=o.aWord,i.add(d);var c=1200*Math.sin(l.angle),r=1200*Math.cos(l.angle),A=c+l.model.position.x,v=r+l.model.position.z;new S.kX(a.position).to({x:A,y:400,z:v},800).easing(S.oY.Quadratic.Out).start().onComplete((function(){a.lookAt(s)})),t.lastActiveModel=l}}else i.getObjectByName("dialog")&&(i.remove(d),t.lastActiveModel&&(t.lastActiveModel.activeEmote("Wave"),t.lastActiveModel=null))})),(0,h.Z)((0,A.Z)(t),"getMouse",(function(e){var t=o.domElement,n=new w.FM8;return n.x=(e.clientX-t.getBoundingClientRect().left)/t.offsetWidth*2-1,n.y=-(e.clientY-t.getBoundingClientRect().top)/t.offsetHeight*2+1,n})),(0,h.Z)((0,A.Z)(t),"getIntersects",(function(e){var t=new w.iMs;t.setFromCamera(e,a);var n=t.intersectObjects(i.children);if(n.length)return n[0]})),(0,h.Z)((0,A.Z)(t),"onWindowResize",(function(){var e=s.clientWidth,t=s.clientHeight;a.aspect=e/t,a.updateProjectionMatrix(),o.setSize(e,t),c.setSize(e,t)})),(0,h.Z)((0,A.Z)(t),"onScrollDown",(function(e){console.log("scroll"),window.scrollTo({top:600,behavior:"smooth"})})),(0,h.Z)((0,A.Z)(t),"renderLoop",(function(){t.models.forEach((function(e){e.update()})),o.render(i,a),c.render(i,a),t.rfa=requestAnimationFrame(t.renderLoop),S.Vx()})),t.models=[],t.modelsMap={},t.lastActiveModel=null,t}(0,v.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=this;s=document.getElementById("friends-canvas-container");var t=document.getElementById("friends-canvas"),n=s.clientHeight,r=s.clientWidth;(o=new w.CP7({canvas:t,antialias:!0})).setPixelRatio(window.devicePixelRatio),o.setSize(r,n),(c=new x.M).setSize(r,n),c.domElement.style.position="absolute",c.domElement.style.top="60px",s.appendChild(c.domElement),(a=new w.cPb(60,r/n,1,3e4)).position.set(1e3,50,1500),(i=new w.xsS).background=new w.Ilk(13426943),i.fog=new w.ybr(13426943,500,1e4),i.add(new w.Mig(6710886));var d=new w.Ox3(14674943,1);d.position.set(50,200,100),d.position.multiplyScalar(1.3),d.castShadow=!0,d.shadow.mapSize.width=1024,d.shadow.mapSize.height=1024;var m=300;d.shadow.camera.left=-m,d.shadow.camera.right=m,d.shadow.camera.top=m,d.shadow.camera.bottom=-m,d.shadow.camera.far=1e3,i.add(d),(l=new M.z(a,c.domElement)).maxPolarAngle=.5*Math.PI,l.minDistance=50,l.maxDistance=5e3;var u=(new w.dpR).load(Z);u.wrapS=u.wrapT=w.rpg,u.repeat.set(25,25),u.anisotropy=16,u.encoding=w.knz;var A=new w.YBo({map:u}),v=new w.Kj0(new w._12(2e4,2e4),A);v.position.y=-250,v.rotation.x=-Math.PI/2,v.receiveShadow=!0,i.add(v);this.friends;fetch("https://qc9pvu.fn.thelarkcloud.com/getFriendList").then((function(e){if(e.ok)return e.json();throw new Error("\u83b7\u53d6\u6570\u636e\u5931\u8d25")})).then((function(t){t.forEach((function(t){var n=t.friendName,o=(t.blogTitle,t.friendAddr,t.aWord,new y({name:n}));o.init(),e.models.push(o),t.model=o,e.modelsMap[n]=t}))})).catch((function(e){return console.log(e)})),this.initDialog(),window.addEventListener("resize",this.onWindowResize),c.domElement.addEventListener("click",this.clickLabel),this.renderLoop()},n.componentWillUnmount=function(){this.models.forEach((function(e){e.despose()})),i.traverse((function(e){"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),window.removeEventListener("resize",this.onWindowResize),c.domElement.removeEventListener("click",this.clickLabel),cancelAnimationFrame(this.rfa)},n.render=function(){return f.createElement(p.Z,null,f.createElement(g.Z,null,f.createElement("title",null,"\u53cb\u94fe\uff08\u672a\u5b8c\u5de5\uff09 | Yle")),f.createElement("div",{id:"friends-canvas-container"},f.createElement("canvas",{id:"friends-canvas"})),f.createElement("div",{className:"friends-scroll-down-bar"},f.createElement("div",{className:"friends-link",onClick:this.onScrollDown},f.createElement("div",{className:"friends-link-text"},"\u6dfb\u52a0\u53cb\u94fe"),f.createElement("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwEAYAAAAHkiXEAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAASAAAAEgARslrPgAAA7FJREFUeNrt2F9MU1ccB/DvuRSooK0gEKts4mJbHdnik0tEXYKwFpOakDGYS4hT14SuZsuMxiHJJtvDtswtVVi3BqNOE5MBCdnMHFFZQhYkI3vYhtNBa4zOLJFiacE/Wyn97WFvmMPFIj0m/j5vN/d7f+ec+0vOaS/AGGOMMcYYYyytRKoPLvnW/8+fR+32KZto016xWmU5bQVKsHJkJJLjcdkiAwOqFzxXlkAg8Lc7J+f+pmT8zqHycr18dM2Sosld584BtXWlnfH49PuGVCeS/Em4Mj6pr9d2UDVebGqSBp8SO/B5dzcA4PWqKtUvcK4SFxLn7+UuW6Y1inIxcuaMXr6oPLZmwUtLl478CKDz1q3p9zXVC3rScQMU4wYolvIZMFt0lD4Q/QaDucKP69fz8qTB6L+e5NNEMfGOWCmi0fS/ivZv/qjJyjKbR28v/Cw3V7oea/LmpMNkQo8AvHMfdd4bIBwA7a2oyMgA4vFIRLqwRPYLwjgx8f+VyTTf85ouPzS6KfvUtm1Yh674zRMnZLnkV1oxdI/e2eMtSDFugGLcAMW4AYql/Cli4dojzuDuwsKsTzMOU3FBgSxHl0WPVrNxo2gGiAIBacFVeA5nk0k6jc3i++FhvfENjbQVz7pc4Q5v5ypfKCTL5dEXFKSDB3FVZAtHXZ204Dg2YLnZLCpQQwcsFmnuGQRw/sYNfETtNO506s0zUln4m3X/8DBQWyvE1NQD60i1AXd+favb2hoOoxJ2IByWvoCP/QMhd0kJgF8QmaFgCIPYomliHXy0ZfVqvfETO7Uurcxo1MuJBvEl1los6ICPOvXr6noTo6idnIxUeu22gitXZvXMu/JbvAUpxg1QjBug2Pz/E+5NvEfvDw7SUGavuOB2S3O5aIfTaEQx/UXelhbdwi5qJ3dzc37AvyDoGRuTxWgfTGJnWZnogI9mqpdNbyDa30+/a2ZRf+yYdJ42OkTfxWJ4JB8i5vAr6FHLrzriDO42mfCzYSvejsXSPT55xX4cPnly7EPPhLV1+/Z0jctbkGLcAMW4AYrN+yE8W4vOLvrB0BKPjw/e75p67fhxvbzYJV6lsupqXCUfHIsXS4MrYEfvxYv0NWKiZ2hIWs+RvE17+voAZKE1fet+bA7hh5Vf7I8G+y5dwj2cRlFpqSxHL4tMCjU0jLV53LaqGT6FKMJbkGLcAMW4AYo9NofwQ2vCetF47RotF5fp+cxMae4u5Wmbo1G0qZ4wY4wxxhhjjDHGGHvS/Qdo3yaWKxU4owAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0wOS0yM1QxNjoxMzoxMCswODowMCZOycMAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMDktMjNUMTY6MTM6MTArMDg6MDBXE3F/AAAAU3RFWHRzdmc6YmFzZS11cmkAZmlsZTovLy9ob21lL2FkbWluL2ljb24tZm9udC90bXAvaWNvbl83azl2ajRhZm9lai9kaXF1eGlhbGFqaWFudG91LnN2Z28J8P0AAAAASUVORK5CYII=",className:"friends-link-arrow"}))),f.createElement("div",{className:"maze-comment"},f.createElement(b.Z,null)))},t}(f.Component),y=function(e){var t=this,n=e.name;(0,h.Z)(this,"init",(function(){t.clock=new w.SUY,(new E.E).load("https://cdn.jsdelivr.net/gh/yleave/yle-blog/models/RobotExpressive.glb",(function(e){var n=e.scene;n.scale.set(60,60,60),n.position.y=-250;var o=e.animations;t.mixer=new w.Xcj(n);for(var a=0;a<o.length;a++){var l=o[a],s=t.mixer.clipAction(l);t.actions[l.name]=s,(t.emotes.indexOf(l.name)>=0||t.state.indexOf(l.name)>=4)&&(s.clampWhenFinished=!0,s.loop=w.jAl)}t.activeAction=t.actions[t.activeState],t.activeAction.play(),n.rotateY(t.angle),i.add(n),t.model=n;var c=n.position.clone();c.y=65;var r=t.createLabel(t.name,c);t.label=r,i.add(r)}))})),(0,h.Z)(this,"activeEmote",(function(e){t.pause=!0,t.fadeToAction(e,.2),t.mixer.addEventListener("finished",t.restoreState)})),(0,h.Z)(this,"restoreState",(function(){t.mixer.removeEventListener("finished",t.restoreState),t.fadeToAction(t.activeState,.2),t.pause=!1})),(0,h.Z)(this,"update",(function(){var e=null!=t.model&&!t.pause,n=+new Date;if(n-t.prevTime>1e4){t.prevTime=n;var o=t.state[Math.floor(Math.random()*t.state.length)];console.log(o),o!==t.activeState&&e&&(t.activeState=o,t.fadeToAction(o,.5),t.model.rotateY(-t.angle),t.angle=2*Math.random()*Math.PI,t.model.rotateY(t.angle))}var a=t.clock.getDelta();t.mixer&&t.mixer.update(a),!e||"Walking"!==t.activeState&&"Running"!==t.activeState||t.move()})),(0,h.Z)(this,"move",(function(){var e=t.speed[t.activeState],n=Math.sin(t.angle)*e,o=Math.cos(t.angle)*e,a=n+t.model.position.x,i=o+t.model.position.z;(a>=2e3||a<=-2e3||i>=2e3||i<=-2e3)&&(console.log("change angle"),t.model.rotateY(-t.angle),t.angle=(t.angle+Math.PI)%(2*Math.PI),t.model.rotateY(t.angle),n=Math.sin(t.angle)*e,o=Math.cos(t.angle)*e,a=n+t.model.position.x,i=o+t.model.position.z),t.label.position.x=a,t.label.position.z=i,t.model.position.x=a,t.model.position.z=i})),(0,h.Z)(this,"createLabel",(function(e,t){var n=document.createElement("div");n.className="model-label",n.textContent=e,n.name=e;var o=new x.j(n);return o.position.set(t.x,t.y,t.z),o})),(0,h.Z)(this,"despose",(function(){var e=t.activeAction,n=t.model;t.mixer.uncacheAction(e,n)})),(0,h.Z)(this,"fadeToAction",(function(e,n){var o=t.activeAction,a=o;o=t.actions[e],a.fadeOut(n),o.reset().setEffectiveTimeScale(1).setEffectiveWeight(1).fadeIn(n).play(),t.activeAction=o})),this.state=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],this.emotes=["Jump","Yes","No","Wave","Punch","ThumbsUp"],this.activeState="Walking",this.mixer=null,this.model=null,this.actions={},this.activeAction=null,this.prevTime=+new Date,this.clock=null,this.speed={Walking:3,Running:5},this.angle=2*Math.random()*Math.PI,this.label=null,this.pause=!1,this.name=n}}}]);